# Dynamic Multi-Crew Theme System Guide

The Dynamic Multi-Crew Theme System is an AI-powered feature that creates immersive personality themes for your Elite Dangerous crew members, providing contextual and ship-specific dialogue that adapts to your gameplay style.

##  Overview

The theme system allows you to:
- **Set AI-powered personality themes** for crew members
- **Generate contextual dialogue** that matches your playstyle
- **Configure ship-specific crews** with unique personalities
- **Create themed EDCoPilot content** automatically
- **Manage multiple ships** with different crew dynamics

##  Quick Start

### Basic Theme Setup

1. **Set a basic theme** for your crew:
   ```
   "Set my EDCoPilot theme to 'space explorer' with context 'veteran pilot exploring the galaxy'"
   ```

2. **Generate themed content**:
   ```
   "Generate a themed templates prompt for Claude Desktop"
   ```

3. **Apply the generated templates**:
   ```
   "Apply these generated templates to my EDCoPilot files: [paste generated templates]"
   ```

### Ship-Specific Crew Configuration

1. **Configure your ship's crew**:
   ```
   "Configure my Anaconda crew with roles: commander, navigator, science, engineer"
   ```

2. **Set individual crew member themes**:
   ```
   "Set my navigator's theme to 'analytical navigator' with context 'former military officer focused on precision'"
   ```

##  Available MCP Tools

### Core Theme Management

#### `set_edcopilot_theme`
Set the overall theme for your crew.

**Parameters:**
- `theme` (string): The personality theme (e.g., "space pirates", "scientific expedition")
- `context` (string): Additional context for the theme
- `apply_immediately` (boolean, optional): Whether to apply the theme immediately

**Example:**
```python
await set_edcopilot_theme(
    theme="military squadron",
    context="elite federation naval unit on frontier patrol",
    apply_immediately=True
)
```

#### `get_theme_status`
View your current theme configuration and ship setups.

**Returns:**
- Current theme information
- Ship configurations
- Crew member themes
- Theme history

**Example:**
```python
status = await get_theme_status()
print(f"Current theme: {status['current_theme']['theme']}")
print(f"Ships configured: {status['ship_count']}")
```

#### `reset_theme`
Clear all theme settings and return to defaults.

**Parameters:**
- `clear_ship_configs` (boolean, optional): Whether to also clear ship configurations

**Example:**
```python
await reset_theme(clear_ship_configs=False)  # Keep ship configs
```

### AI-Powered Generation

#### `generate_themed_templates_prompt`
Create a Claude Desktop prompt for generating themed content.

**Parameters:**
- `crew_role` (string, optional): Specific crew role to focus on
- `template_count` (integer, optional): Number of templates to generate

**Returns:**
- Detailed prompt for Claude Desktop
- Current theme context
- Validation guidelines

**Example:**
```python
prompt_data = await generate_themed_templates_prompt(
    crew_role="navigator",
    template_count=10
)
print(prompt_data["prompt"])  # Copy this to Claude Desktop
```

#### `apply_generated_templates`
Apply AI-generated templates to EDCoPilot with validation.

**Parameters:**
- `generated_templates` (list): Templates generated by AI
- `backup_existing` (boolean, optional): Create backup before applying

**Returns:**
- Success status
- Files written
- Validation results

**Example:**
```python
templates = [
    "condition:Docked|Welcome aboard, Commander. All systems nominal.",
    "condition:Supercruise|Maintaining supercruise speed, sir."
]

result = await apply_generated_templates(
    generated_templates=templates,
    backup_existing=True
)
```

### Ship and Crew Management

#### `configure_ship_crew`
Set up ship-specific crew roles and personalities.

**Parameters:**
- `ship_name` (string): Name of the ship
- `crew_roles` (list, optional): List of crew roles (auto-detected if not provided)

**Returns:**
- Ship configuration details
- Crew roles assigned
- Default themes applied

**Example:**
```python
config = await configure_ship_crew(
    ship_name="Deep Space Explorer",
    crew_roles=["commander", "navigator", "science", "engineer"]
)
```

#### `set_crew_member_theme`
Configure individual crew member themes and contexts.

**Parameters:**
- `ship_name` (string): Ship where the crew member serves
- `crew_role` (string): Role of the crew member
- `theme` (string): Personality theme for this crew member
- `context` (string): Additional context

**Example:**
```python
await set_crew_member_theme(
    ship_name="Deep Space Explorer",
    crew_role="science",
    theme="enthusiastic researcher",
    context="xenobiologist excited about new discoveries"
)
```

#### `generate_crew_setup_prompt`
Generate prompts for coordinating multi-crew themes.

**Parameters:**
- `ship_name` (string): Ship to configure
- `overall_theme` (string): Overall crew theme
- `overall_context` (string): Overall context
- `crew_roles` (list, optional): Specific roles to configure

**Returns:**
- Coordination prompt for AI
- Role-specific guidance
- Theme consistency guidelines

**Example:**
```python
prompt = await generate_crew_setup_prompt(
    ship_name="Combat Vessel",
    overall_theme="elite military unit",
    overall_context="veteran combat squadron",
    crew_roles=["commander", "gunner", "tactical"]
)
```

### Preview and Backup

#### `preview_themed_content`
Preview themed content before applying to files.

**Parameters:**
- `crew_role` (string, optional): Focus on specific crew role
- `template_count` (integer, optional): Number of preview templates

**Returns:**
- Example templates
- Current theme application
- Preview without file modification

**Example:**
```python
preview = await preview_themed_content(crew_role="engineer")
for template in preview["example_templates"]:
    print(template)
```

#### `backup_current_themes`
Create backups of current theme configurations.

**Returns:**
- Backup file path
- Themes backed up
- Timestamp

**Example:**
```python
backup = await backup_current_themes()
print(f"Themes backed up to: {backup['backup_path']}")
```

##  Usage Examples

### Example 1: Space Exploration Crew

```python
# Set up exploration theme
await set_edcopilot_theme(
    theme="scientific expedition",
    context="deep space research mission to distant nebula"
)

# Configure ship crew
await configure_ship_crew(
    ship_name="Research Vessel Endeavor",
    crew_roles=["commander", "navigator", "science", "engineer"]
)

# Set specialized crew themes
await set_crew_member_theme(
    ship_name="Research Vessel Endeavor",
    crew_role="science",
    theme="excited xenobiologist",
    context="PhD in astrobiology, first deep space mission"
)

await set_crew_member_theme(
    ship_name="Research Vessel Endeavor",
    crew_role="navigator",
    theme="precise cartographer",
    context="meticulous route planner with 20 years experience"
)

# Generate and apply content
prompt_data = await generate_themed_templates_prompt(template_count=15)
# [Use prompt in Claude Desktop to generate templates]
# await apply_generated_templates(generated_templates=result)
```

### Example 2: Combat Squadron

```python
# Set military theme
await set_edcopilot_theme(
    theme="elite combat squadron",
    context="federal navy special operations unit"
)

# Configure combat ship
await configure_ship_crew(
    ship_name="FNS Defender",
    crew_roles=["commander", "tactical", "gunner", "engineer"]
)

# Generate crew coordination prompt
crew_prompt = await generate_crew_setup_prompt(
    ship_name="FNS Defender",
    overall_theme="disciplined military unit",
    overall_context="elite federal navy combat veterans",
    crew_roles=["commander", "tactical", "gunner", "engineer"]
)

# Preview themed content
preview = await preview_themed_content()
print("Preview templates:")
for template in preview["example_templates"]:
    print(f"  {template}")
```

### Example 3: Trading Consortium

```python
# Set trading theme
await set_edcopilot_theme(
    theme="merchant trading consortium",
    context="profitable independent traders seeking optimal routes"
)

# Configure multiple trading ships
for ship in ["Trade Hauler Alpha", "Trade Hauler Beta", "Escort Fighter"]:
    crew_roles = ["commander", "navigator", "cargo"] if "Hauler" in ship else ["commander", "gunner"]
    await configure_ship_crew(ship_name=ship, crew_roles=crew_roles)

# Set ship-specific themes
await set_crew_member_theme(
    ship_name="Trade Hauler Alpha",
    crew_role="cargo",
    theme="efficiency expert",
    context="logistics specialist focused on profit optimization"
)

await set_crew_member_theme(
    ship_name="Escort Fighter",
    crew_role="gunner",
    theme="protective escort",
    context="security specialist keeping traders safe"
)

# Check status
status = await get_theme_status()
print(f"Configured {status['ship_count']} ships with {status['current_theme']['theme']} theme")
```

### Example 4: Multi-Role Fleet

```python
# Set up different themes for different ships
ships_config = [
    {
        "name": "Explorer",
        "theme": "scientific curiosity",
        "context": "research expedition seeking new discoveries",
        "roles": ["commander", "navigator", "science"]
    },
    {
        "name": "Trader",
        "theme": "profit-focused merchants",
        "context": "independent traders maximizing profits",
        "roles": ["commander", "navigator", "cargo"]
    },
    {
        "name": "Fighter",
        "theme": "combat veterans",
        "context": "experienced bounty hunters",
        "roles": ["commander", "gunner"]
    }
]

for ship_config in ships_config:
    # Set theme for this ship type
    await set_edcopilot_theme(
        theme=ship_config["theme"],
        context=ship_config["context"]
    )

    # Configure ship
    await configure_ship_crew(
        ship_name=ship_config["name"],
        crew_roles=ship_config["roles"]
    )

    # Generate ship-specific content
    prompt = await generate_themed_templates_prompt(template_count=8)
    # [Apply templates specific to this ship's role]

# Create backup of all configurations
backup = await backup_current_themes()
print(f"Multi-ship fleet configuration backed up to: {backup['backup_path']}")
```

##  Advanced Usage

### Theme Coordination Workflow

For the most immersive experience, follow this workflow:

1. **Define Overall Theme**: Start with a broad personality theme
2. **Configure Ship Types**: Set up different ships for different roles
3. **Specialize Crew Members**: Give individual crew members unique personalities
4. **Generate Content**: Use AI prompts to create themed dialogue
5. **Preview and Refine**: Test content before applying
6. **Apply and Backup**: Save configurations and create backups

### AI Prompt Tips

When using the generated prompts in Claude Desktop:

1. **Be Specific**: Add details about your playstyle and preferences
2. **Provide Context**: Mention recent activities or goals
3. **Request Variety**: Ask for different dialogue types (docking, combat, exploration)
4. **Specify Tone**: Indicate desired formality, humor level, or personality traits
5. **Iterate**: Generate multiple sets and combine the best elements

### Theme Management Best Practices

1. **Regular Backups**: Create backups before major changes
2. **Theme Consistency**: Ensure crew themes complement each other
3. **Ship Specificity**: Match themes to ship purposes (exploration, combat, trading)
4. **Gradual Changes**: Modify themes incrementally for seamless transitions
5. **Preview First**: Always preview content before applying to files

##  Integration with Claude Desktop

### Setting Up Themed Content Generation

1. **Get Generation Prompt**:
   ```
   "Generate a themed templates prompt for my current configuration"
   ```

2. **Copy Prompt to New Claude Chat**:
   - Open a new conversation in Claude Desktop
   - Paste the generated prompt
   - Add any specific requests or modifications

3. **Generate Templates**:
   - Claude will create themed dialogue templates
   - Review for quality and consistency
   - Make any desired adjustments

4. **Apply Templates**:
   ```
   "Apply these generated templates to my EDCoPilot files: [paste templates]"
   ```

### Example Claude Desktop Interaction

```
User: Generate a themed templates prompt for my current configuration

Claude: I'll generate a themed templates prompt for your Elite Dangerous crew. Here's your personalized prompt:

# EDCoPilot Theme Generation Request

**Theme**: scientific expedition
**Context**: deep space research mission to distant nebula
**Ship**: Research Vessel Endeavor
**Crew Roles**: commander, navigator, science, engineer

## Request
Please generate 15 EDCoPilot dialogue templates that capture the personality and context above...

[Generated prompt continues with detailed instructions]

User: [Copy prompt to new Claude chat]

New Claude Chat: [Generated templates]
condition:Docked|Welcome to the station, Commander. Shall we resupply for our research mission?
condition:Supercruise|Maintaining research trajectory. Nebula approach in T-minus 2 hours.
condition:Scanned|Fascinating! This stellar phenomenon warrants detailed analysis.
[... more templates]

User: Apply these generated templates to my EDCoPilot files: [paste templates]

Claude: I'll apply these themed templates to your EDCoPilot files with validation...

[OK] Applied 15 templates successfully
[OK] Backed up existing files
[OK] All templates passed grammar validation
```

##  Ship Type Defaults

The system automatically configures appropriate crew sizes based on ship types:

### Small Ships (1-2 crew)
- **Sidewinder, Eagle**: Commander only
- **Hauler, Adder, Viper**: Commander + Engineer

### Medium Ships (3-4 crew)
- **Asp Explorer, Python, Vulture**: Commander + Navigator + Engineer + Science Officer
- **Fer-de-Lance, Mamba**: Commander + Navigator + Engineer + Gunner

### Large Ships (5-6 crew)
- **Anaconda, Corvette, Cutter**: Commander + Navigator + Science Officer + Engineer + Security Chief + Communications Officer
- **Type-9, Type-10**: Commander + Navigator + Engineer + Cargo Specialist + Security Chief + Communications Officer

##  Theme Categories and Examples

### Exploration Themes
- **"scientific expedition"** - Research-focused, analytical, discovery-oriented
- **"independent explorer"** - Adventure-seeking, freedom-loving, resourceful
- **"cartographer guild"** - Precise, methodical, map-making focused
- **"xenobiologist team"** - Life-form focused, excited about biology

### Combat Themes
- **"military squadron"** - Disciplined, tactical, chain-of-command
- **"bounty hunters"** - Profit-motivated, aggressive, competitive
- **"system defense force"** - Protective, community-focused, vigilant
- **"pirate crew"** - Rebellious, opportunistic, anti-authority

### Trading Themes
- **"merchant consortium"** - Profit-focused, efficiency-driven, market-aware
- **"independent traders"** - Freedom-loving, entrepreneurial, risk-taking
- **"corporate fleet"** - Professional, procedure-following, quota-driven
- **"smuggling operation"** - Secretive, risk-taking, authority-avoiding

### Engineering Themes
- **"tech innovators"** - Cutting-edge, experimental, modification-focused
- **"maintenance crew"** - Practical, safety-focused, reliability-oriented
- **"ship modders"** - Creative, performance-focused, customization-obsessed
- **"systems specialists"** - Technical, precise, optimization-focused

##  Troubleshooting

### Common Issues

#### Templates Not Applying
```python
# Check theme status first
status = await get_theme_status()
if not status["current_theme"]:
    await set_edcopilot_theme("your_theme", "your_context")

# Verify templates are valid
preview = await preview_themed_content()
```

#### Crew Configuration Problems
```python
# Reset and reconfigure
await reset_theme(clear_ship_configs=True)
await configure_ship_crew("Your Ship Name")
```

#### File Permission Issues
```python
# Backup first, then apply
backup = await backup_current_themes()
result = await apply_generated_templates(templates, backup_existing=True)
```

### Validation Errors

The system validates all templates against EDCoPilot grammar:

- **Format**: `condition:State|dialogue`
- **Valid Conditions**: Docked, Supercruise, FuelLow, FuelCritical, etc.
- **Token Support**: {SystemName}, {StationName}, {ShipName}, etc.

### Performance Optimization

For large fleets or complex themes:

```python
# Batch operations
ships = ["Ship1", "Ship2", "Ship3"]
for ship in ships:
    await configure_ship_crew(ship)
    # Small delay to prevent overwhelm
    await asyncio.sleep(0.1)

# Regular cleanup
backup = await backup_current_themes()
```

##  Integration Examples

### With Other MCP Tools

```python
# Get current game state
location = await get_current_location()
ship_status = await get_current_ship()

# Set contextual theme based on location
if location["docked"]:
    theme_context = f"docked at {location['station_name']} in {location['system_name']}"
else:
    theme_context = f"in space near {location['system_name']}"

await set_edcopilot_theme("adaptive_crew", theme_context)
```

### With Real-time Events

```python
# React to game events
recent_events = await get_recent_events(minutes=10)
for event in recent_events:
    if event["event_type"] == "FSDJump":
        # Update theme context for new system
        new_context = f"exploring {event['StarSystem']}"
        await set_edcopilot_theme("explorer", new_context)
```

##  Advanced Theme Coordination

### Multi-Ship Fleet Management

```python
async def setup_exploration_fleet():
    """Set up a coordinated exploration fleet with specialized ships."""

    fleet_config = {
        "Science Vessel": {
            "theme": "research specialists",
            "context": "detailed scientific analysis team",
            "roles": ["commander", "science", "navigator", "engineer"]
        },
        "Support Ship": {
            "theme": "logistics support",
            "context": "supply and maintenance crew",
            "roles": ["commander", "engineer", "cargo", "comms"]
        },
        "Scout Ship": {
            "theme": "advance reconnaissance",
            "context": "fast scouts finding safe routes",
            "roles": ["commander", "navigator"]
        }
    }

    for ship_name, config in fleet_config.items():
        await set_edcopilot_theme(config["theme"], config["context"])
        await configure_ship_crew(ship_name, config["roles"])

        # Generate ship-specific content
        prompt = await generate_themed_templates_prompt(template_count=8)
        print(f"Generated prompt for {ship_name}:")
        print(prompt["prompt"])
        print("-" * 50)

# Execute fleet setup
await setup_exploration_fleet()
```

##  API Reference Summary

| Tool | Purpose | Key Parameters |
|------|---------|----------------|
| `set_edcopilot_theme` | Set overall crew theme | `theme`, `context` |
| `get_theme_status` | View current configuration | None |
| `reset_theme` | Clear theme settings | `clear_ship_configs` |
| `generate_themed_templates_prompt` | Create AI generation prompts | `crew_role`, `template_count` |
| `apply_generated_templates` | Apply AI-generated content | `generated_templates` |
| `configure_ship_crew` | Set up ship crews | `ship_name`, `crew_roles` |
| `set_crew_member_theme` | Individual crew themes | `ship_name`, `crew_role`, `theme` |
| `generate_crew_setup_prompt` | Multi-crew coordination | `ship_name`, `overall_theme` |
| `preview_themed_content` | Preview before applying | `crew_role` |
| `backup_current_themes` | Create configuration backups | None |

---

**For more information, see:**
- [EDCoPilot Grammar Specification](edcopilot-chatter-grammar.md)
- [Project README](../README.md)
- [API Documentation](API_REFERENCE.md)
